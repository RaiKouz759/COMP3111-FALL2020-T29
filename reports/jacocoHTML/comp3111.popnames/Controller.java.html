<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Controller.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">PopNames3111</a> &gt; <a href="index.source.html" class="el_package">comp3111.popnames</a> &gt; <span class="el_source">Controller.java</span></div><h1>Controller.java</h1><pre class="source lang-java linenums">/**
 * Building on the sample skeleton for 'ui.fxml' COntroller Class generated by SceneBuilder 
 */
package comp3111.popnames;

import java.io.IOException;

import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.collections.FXCollections;
import javafx.collections.ListChangeListener;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.chart.BarChart;
import javafx.scene.chart.XYChart;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.PieChart;
import javafx.scene.control.Button;
import javafx.scene.control.Tab;
import javafx.scene.control.TabPane;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.control.ToggleGroup;
import javafx.scene.control.cell.MapValueFactory;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.control.RadioButton;
import javafx.scene.control.TableView;
import javafx.scene.control.SelectionMode;
import javafx.scene.control.TableColumn;
import javafx.scene.control.ProgressBar;
import javafx.scene.control.ChoiceBox;
import javafx.scene.control.Label;
import javafx.scene.control.Alert;
import javafx.scene.control.Alert.AlertType;
import javafx.scene.layout.VBox;
import javafx.scene.shape.Rectangle;
import javafx.scene.layout.Region;
import javafx.scene.text.Text;
import javafx.util.Pair;
import javafx.concurrent.Task;

import java.lang.NumberFormatException;
import java.net.URL;
import java.util.concurrent.Executor;
import java.util.concurrent.Executors;
import java.util.concurrent.ExecutorService;

import java.text.DecimalFormat;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Map.Entry;
import java.util.ResourceBundle;

import java.io.File;
import java.io.FileNotFoundException;



<span class="fc" id="L66">public class Controller implements Initializable{</span>

    @FXML
    private Tab tabTaskZero;

    @FXML
    private TextField textfieldNameF;

    @FXML
    private TextField textfieldYear;

    @FXML
    private Button buttonRankM;

    @FXML
    private TextField textfieldNameM;
    
    @FXML
    private Button task1Button;

    @FXML
    private Button buttonRankF;

    @FXML
    private Button buttonTopM;

    @FXML
    private Button buttonTopF;

    @FXML
    private Button buttonSummary;
    
    @FXML
    private Tab tabReport1;

    @FXML
    private ToggleGroup T1;

    @FXML
    private Tab tabReport2;

    @FXML
    private TextField task2TextName;

    @FXML
    private ToggleGroup task2Toggle;

    @FXML
    private RadioButton task2RadioMale;

    @FXML
    private RadioButton task2RadioFemale;

    @FXML
    private TextField task2TextStartPeriod;

    @FXML
    private TextField task2TextEndPeriod;

    @FXML
    private Button task2ButtonGenerate;

    @FXML
    private TextArea task2TextResult;

    @FXML
    private TableView&lt;Map&gt; task2TableResult;

    @FXML
    private LineChart&lt;Integer, Number&gt; task2LineChartResult;

    @FXML
    private Tab tabReport3;

    @FXML
    private ToggleGroup T111;

    @FXML
    private Tab tabApp1;

    @FXML
    private Tab tabApp2;

    @FXML
    private Tab tabApp3;

    @FXML
    private TextField task6TextName1;

    @FXML
    private ToggleGroup task6Toggle1;

    @FXML
    private RadioButton task6RadioMale1;

    @FXML
    private RadioButton task6RadioFemale1;

    @FXML
    private TextField task6TextYear1;

    @FXML
    private TextField task6TextName2;

    @FXML
    private ToggleGroup task6Toggle2;

    @FXML
    private RadioButton task6RadioMale2;

    @FXML
    private RadioButton task6RadioFemale2;

    @FXML
    private ToggleGroup task6Toggle3;

    @FXML
    private RadioButton task6RadioYounger;

    @FXML
    private RadioButton task6RadioOlder;

    @FXML
    private RadioButton task6RadioCustom;

    @FXML
    private TextField task6TextYear2;

    @FXML
    private ToggleGroup task6Toggle4;

    @FXML
    private RadioButton task6RadioNKT6;

    @FXML
    private RadioButton task6RadioNorm;

    @FXML
    private RadioButton task6RadioLinear;

    @FXML
    private Button task6ButtonReport;

    @FXML
    private Button task6ButtonCancel;

    @FXML
    private ProgressBar task6ProgressBar;

    @FXML
    private Label task6TextResult;

    @FXML
    private PieChart task6PieChartResult;

    @FXML
    private LineChart&lt;Integer, Number&gt; task6LineChartResult;

    Task&lt;Pair&lt;ArrayList&lt;Pair&lt;Double, Double&gt;&gt;, ArrayList&lt;Pair&lt;Double, Double&gt;&gt;&gt;&gt; task6LinTask0;
    Task&lt;Pair&lt;Double, Double&gt;&gt; task6LinTask1;
    Task&lt;Pair&lt;Double, Double&gt;&gt; task6LinTask2;

<span class="fc" id="L228">    Pair&lt;ArrayList&lt;Pair&lt;Double, Double&gt;&gt;, ArrayList&lt;Pair&lt;Double, Double&gt;&gt;&gt; tasks6Points = null;</span>

    @FXML
    private TextArea textAreaConsole;
    
    @FXML
    private TextField numRankTextField;
    
    @FXML
    private RadioButton maleRadioButton;
    
    @FXML
    private RadioButton femaleRadioButton;

    @FXML
    private TextField endPeriodTextField;

    @FXML
    private TextField startPeriodTextField;
    
    @FXML
    private TableView&lt;Map&gt; report1Table;
    
    @FXML   
    private ChoiceBox&lt;String&gt; app2ChoiceBox;
    
    @FXML
    private BarChart&lt;String, Integer&gt; rep1BarChart;
    
    @FXML
    private TextArea rep1Comment;
    
    @FXML
    private Label rep1Label;

    @FXML
    private Rectangle step2Cover;
    

    @FXML
    private RadioButton step2Radio4;

    @FXML
    private RadioButton step2Radio5;

    @FXML
    private RadioButton step2Radio6;
    
    //activity 5 FXML objects
    @FXML
    private TextField app2YourName;

    @FXML
    private RadioButton app2YourGenderM;

    @FXML
    private RadioButton app2YourGenderF;

    @FXML
    private TextField app2YOB;

    @FXML
    private RadioButton app2SoulGenderM;

    @FXML
    private RadioButton app2SoulGenderF;

    @FXML
    private RadioButton app2SoulYounger;

    @FXML
    private RadioButton app2SoulOlder;
    
    @FXML
    private Label app2PredictSentence;

    @FXML
    private Label app2Answer;
    
    @FXML
    private Button app2Button;
    
    @FXML
    private RadioButton app2RadioNK;

    @FXML
    private ToggleGroup T3;

    @FXML
    private RadioButton app2RadioJaro;
    

    @FXML
    private RadioButton step2Radio1;

    @FXML
    private ToggleGroup T5;

    @FXML
    private RadioButton step2Radio2;

    @FXML
    private RadioButton step2Radio3;

    @FXML
    private Label step2Label;

    @FXML
    private Button step2Button;
    // end of activity5 objects

    @FXML
    private ChoiceBox&lt;String&gt; historyChoice;

    @FXML
    private TextArea historyText;
    
    @FXML
    private TextField task3_year_end;

    @FXML
    private TextField task3_year_start;

    @FXML
    private Button task3_report;
    
    @FXML
    private RadioButton t3_f;
    
    @FXML
    private RadioButton t3_m;
    
    @FXML
    private ToggleGroup T3_toggle_group;
    
    @FXML
    private TextField t3_topN;
    
    @FXML
    private TextArea t3_text_output;
    
    @FXML
    private TableView&lt;Map&gt; task3_table;
    
    @FXML
    private TextField t4_dname;

    @FXML
    private TextField t4_mname;

    @FXML
    private TextField t4_dyob;

    @FXML
    private TextField t4_myob;

    @FXML
    private TextField t4_vyear;

    @FXML
    private Button t4_gr;
    
    @FXML
    private RadioButton t4_nkt4;

    @FXML
    private ToggleGroup T4_algorithm;

    @FXML
    private RadioButton t4_jaro;
    
    @FXML
    private TextArea t4_text_output;
    
    @FXML
    private Label t4_boy_label;

    @FXML
    private Label t4_girl_label;

    @FXML
    private Label t4_b1;

    @FXML
    private Label t4_b2;

    @FXML
    private Label t4_b3;

    @FXML
    private Label t4_g1;

    @FXML
    private Label t4_g2;

    @FXML
    private Label t4_g3;
    
    //history elements
    @FXML
    private Button historyButtonRerun;

    @FXML
    private TableView&lt;Map&gt; historyTableView;
    // end of history 
    
    @FXML
    public ObservableList&lt;String&gt; log_obList;
    
    @FXML
    private Tab historyTab;

    @FXML
    private TabPane tabpane;



    
    

    @Override
    public void initialize(URL location, ResourceBundle resources) {
        
        // this part is to initialize the choiceBox in activity5
<span class="fc" id="L452">        ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L453">        list.add(&quot;NK-T5&quot;);</span>
<span class="fc" id="L454">        list.add(&quot;Levenshtein Distance&quot;);</span>
<span class="fc" id="L455">        ObservableList&lt;String&gt; obList = FXCollections.observableList(list);</span>
<span class="fc" id="L456">        app2ChoiceBox.setItems(obList);</span>
<span class="fc" id="L457">        app2ChoiceBox.setValue(&quot;NK-T5&quot;);</span>
        // end of initialization of activity5
        
        // initialization for activity 2
<span class="fc" id="L461">        task2TableResult.getColumns().clear();</span>
<span class="fc" id="L462">        task2TableResult.refresh();</span>

<span class="fc" id="L464">        TableColumn&lt;Map,String&gt; yearColumn = new TableColumn&lt;&gt;(&quot;Year&quot;);</span>
<span class="fc" id="L465">        yearColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;year&quot;));</span>
<span class="fc" id="L466">        yearColumn.setResizable(false);</span>
        // yearColumn.prefWidthProperty().bind(task2TableResult.widthProperty().multiply(0.2));
        
<span class="fc" id="L469">        TableColumn&lt;Map, String&gt; rankColumn = new TableColumn&lt;&gt;(&quot;Rank&quot;);</span>
<span class="fc" id="L470">        rankColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;rank&quot;));</span>
<span class="fc" id="L471">        rankColumn.setResizable(false);</span>
        // rankColumn.prefWidthProperty().bind(task2TableResult.widthProperty().multiply(0.2));
        
<span class="fc" id="L474">        TableColumn&lt;Map, String&gt; countColumn = new TableColumn&lt;&gt;(&quot;Count&quot;);</span>
<span class="fc" id="L475">        countColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;count&quot;));</span>
<span class="fc" id="L476">        countColumn.setResizable(false);</span>
        // countColumn.prefWidthProperty().bind(task2TableResult.widthProperty().multiply(0.2));

<span class="fc" id="L479">        TableColumn&lt;Map, String&gt; percentageColumn = new TableColumn&lt;&gt;(&quot;Percentage&quot;);</span>
<span class="fc" id="L480">        percentageColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;percentage&quot;));</span>
<span class="fc" id="L481">        percentageColumn.setResizable(false);</span>
        // percentageColumn.prefWidthProperty().bind(task2TableResult.widthProperty().multiply(0.4));
<span class="fc" id="L483">        task2TableResult.setColumnResizePolicy(TableView.CONSTRAINED_RESIZE_POLICY);</span>
<span class="fc" id="L484">        task2TableResult.getColumns().addAll(yearColumn, rankColumn, countColumn, percentageColumn);</span>
        
        // end of initializatin for activity 2

        // initialization for activity 6

<span class="fc" id="L490">        task6PieChartResult.setStartAngle(90);</span>
<span class="fc" id="L491">        task6PieChartResult.setClockwise(true);</span>
<span class="fc" id="L492">        task6PieChartResult.setVisible(false);</span>
<span class="fc" id="L493">        resetTask6();</span>

        // end of initialization for activity 6


<span class="fc" id="L498">        historyTableView.getSelectionModel().setSelectionMode(SelectionMode.SINGLE);</span>
        // display the change in the tableview after selecting the choicebox. 
<span class="fc" id="L500">        historyChoice.getSelectionModel().selectedItemProperty().addListener(new ChangeListener&lt;String&gt;() {</span>

			@Override
			public void changed(ObservableValue&lt;? extends String&gt; observable, String oldValue, String newValue) {
<span class="fc" id="L504">				System.out.println(&quot;entering the changed funciton of the historychoice&quot;);</span>
				// clear the contents of the table
<span class="fc" id="L506">		        historyTableView.getColumns().clear();</span>
<span class="fc" id="L507">		        historyTableView.getItems().clear();</span>
<span class="fc" id="L508">		        historyTableView.refresh();</span>
		        
		        // initialize the columns
<span class="fc" id="L511">		        TableColumn&lt;Map,String&gt; dateTimeColumn = new TableColumn&lt;&gt;(&quot;Date &amp; Time&quot;);</span>
<span class="fc" id="L512">		        dateTimeColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;datetime&quot;));</span>
<span class="fc" id="L513">		        historyTableView.getColumns().add(dateTimeColumn);</span>
		        
<span class="fc" id="L515">		        TableColumn&lt;Map,String&gt; taskColumn = new TableColumn&lt;&gt;(&quot;Task&quot;);</span>
<span class="fc" id="L516">		        taskColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;task&quot;));</span>
<span class="fc" id="L517">		        historyTableView.getColumns().add(taskColumn);</span>

<span class="fc" id="L519">		        TableColumn&lt;Map,String&gt; inputColumn = new TableColumn&lt;&gt;(&quot;Data Inputs&quot;);</span>
<span class="fc" id="L520">		        inputColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;inputs&quot;));</span>
<span class="fc" id="L521">		        historyTableView.getColumns().add(inputColumn);</span>
		        
		        // add the relavant data to the table rows
		        try {
<span class="fc" id="L525">					ArrayList&lt;String&gt; queryList = History.readHistory(newValue);</span>
<span class="fc" id="L526">					System.out.println(queryList.size());</span>
					ObservableList&lt;Map&lt;String, Object&gt;&gt; items =
<span class="fc" id="L528">			                FXCollections.&lt;Map&lt;String, Object&gt;&gt;observableArrayList();</span>
					
					//parse the string from the arraylist starting from the most current query date, task, inputs
<span class="fc bfc" id="L531" title="All 2 branches covered.">					for (int i=queryList.size() - 1; i&gt;=0; i--) {</span>
<span class="fc" id="L532">						System.out.println(&quot;in querylist for loop&quot;);</span>
<span class="fc" id="L533">						Map&lt;String, Object&gt; item = new HashMap&lt;&gt;();</span>
<span class="fc" id="L534">						String cur = queryList.get(i);</span>
<span class="fc" id="L535">						ArrayList&lt;String&gt; components = new ArrayList&lt;&gt;(Arrays.asList(cur.split(&quot;,[ ]*&quot;)));</span>
<span class="pc bpc" id="L536" title="1 of 2 branches missed.">						if (components.size() != 3) {</span>
<span class="nc" id="L537">							System.out.println(&quot;Something went wrong&quot;);</span>
<span class="nc" id="L538">							showWarning(&quot;Error&quot;, &quot;components array is not size 3&quot;);</span>
<span class="nc" id="L539">							return;</span>
						}
<span class="fc" id="L541">						item.put(&quot;datetime&quot;, components.get(0));</span>
<span class="fc" id="L542">						item.put(&quot;task&quot;, components.get(1));</span>
<span class="fc" id="L543">						item.put(&quot;inputs&quot;, components.get(2));</span>
<span class="fc" id="L544">						System.out.println(&quot;testing component&quot;);</span>
<span class="fc" id="L545">						items.add(item);</span>
<span class="fc" id="L546">						System.out.println(components.get(2));</span>
					}
					
<span class="fc" id="L549">					historyTableView.getItems().addAll(items);</span>
					
<span class="nc" id="L551">				} catch (FileNotFoundException e) {</span>
<span class="nc" id="L552">					e.printStackTrace();</span>
<span class="nc" id="L553">					showWarning(&quot;File not found&quot;, &quot;File is not found. &quot;);</span>
<span class="nc" id="L554">					return;</span>
<span class="fc" id="L555">				}		        </span>
		        
<span class="fc" id="L557">			}</span>
		}
        );

        
<span class="fc" id="L562">    }</span>
    /**
     * 
     */
    @FXML
    void clickHistory() {
<span class="fc bfc" id="L568" title="All 2 branches covered.">    	if (historyTab.isSelected()) {</span>
<span class="fc" id="L569">    		String filePath = new File(&quot;&quot;).getAbsolutePath();</span>
<span class="fc" id="L570">    		filePath = filePath.concat(&quot;/src/main/resources/logs&quot;);</span>
    		
    		// create directory if it does not exists
<span class="fc" id="L573">    		new File(filePath).mkdirs();</span>
<span class="fc" id="L574">    		File dir = new File(filePath);</span>
<span class="fc" id="L575">    		File[] directoryListing = dir.listFiles();</span>
<span class="pc bpc" id="L576" title="1 of 2 branches missed.">    		if (directoryListing != null) {</span>
<span class="fc" id="L577">    	        ArrayList&lt;String&gt; log_list = new ArrayList&lt;String&gt;();</span>
<span class="fc bfc" id="L578" title="All 2 branches covered.">    		    for (File child : directoryListing) {</span>
<span class="fc" id="L579">    		      log_list.add(child.getName());</span>
    		    }
<span class="fc" id="L581">    	        log_obList = FXCollections.observableList(log_list);</span>
<span class="fc" id="L582">    	        historyChoice.setItems(log_obList);</span>
<span class="pc bpc" id="L583" title="1 of 2 branches missed.">    	        if (log_obList.size() &gt; 0) {</span>
<span class="fc" id="L584">		        	historyChoice.setValue(log_obList.get(log_obList.size()-1));</span>
		        }
	    	}
	    }
<span class="fc" id="L588">    }</span>

    /**
     * 
     */
    @FXML
    void historyRerun() {
<span class="pc bpc" id="L595" title="1 of 2 branches missed.">    	if (historyTableView.getSelectionModel().isEmpty()) {</span>
<span class="nc" id="L596">    		showWarning(&quot;Invalid Selection&quot;, &quot;Please select one history record to rerun.&quot;);</span>
<span class="nc" id="L597">    		return;</span>
    	}
<span class="fc" id="L599">    	Map&lt;String, String&gt; entry = historyTableView.getSelectionModel().getSelectedItem();</span>
<span class="fc" id="L600">    	String task = entry.get(&quot;task&quot;);</span>
<span class="fc" id="L601">    	String inputs = entry.get(&quot;inputs&quot;);</span>
<span class="pc bpc" id="L602" title="5 of 7 branches missed.">		switch (task.substring(task.length() - 1)) {</span>
			case &quot;1&quot;:
<span class="fc" id="L604">				tabpane.getSelectionModel().select(0);</span>
<span class="fc" id="L605">				rerunTask1(inputs);</span>
<span class="fc" id="L606">				break;</span>
			case &quot;2&quot;:
<span class="nc" id="L608">				tabpane.getSelectionModel().select(1);</span>
<span class="nc" id="L609">				rerunTask2(inputs);</span>
<span class="nc" id="L610">				break;</span>
			case &quot;3&quot;:
<span class="nc" id="L612">				tabpane.getSelectionModel().select(2);</span>
<span class="nc" id="L613">				rerunTask3(inputs);</span>
<span class="nc" id="L614">				break;</span>
			case &quot;4&quot;:
<span class="nc" id="L616">				tabpane.getSelectionModel().select(3);</span>
<span class="nc" id="L617">				rerunTask4(inputs);</span>
<span class="nc" id="L618">				break;</span>
			case &quot;5&quot;:
<span class="fc" id="L620">				tabpane.getSelectionModel().select(4);</span>
<span class="fc" id="L621">				rerunTask5(inputs);</span>
<span class="fc" id="L622">				break;</span>
			case &quot;6&quot;:
<span class="nc" id="L624">				tabpane.getSelectionModel().select(5);</span>
<span class="nc" id="L625">				rerunTask6(inputs);</span>
<span class="nc" id="L626">				break;</span>
			default:
<span class="nc" id="L628">				showWarning(&quot;Invalid Task Number&quot;, &quot;There is something wrong with this record.&quot;);</span>
<span class="nc" id="L629">				return;</span>

		}
<span class="fc" id="L632">    }</span>

    @FXML
    void rerunTask1(String inputs) {
		//fill in the elements here
// parse the string of inputs and rerun the query
<span class="fc" id="L638">		ArrayList&lt;String&gt; input_data = new ArrayList&lt;&gt;(Arrays.asList(inputs.split(&quot;;&quot;)));</span>
<span class="fc" id="L639">		HashMap&lt;String, String&gt; input_map = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L640" title="All 2 branches covered.">		for (String s : input_data) {</span>
<span class="fc" id="L641">			String[] input_pair = s.split(&quot;:&quot;);</span>
<span class="fc" id="L642">			input_map.put(input_pair[0], input_pair[1]);</span>
<span class="fc" id="L643">		}</span>
<span class="fc" id="L644">		numRankTextField.setText(input_map.get(&quot;numRankTextField&quot;));</span>
<span class="pc bpc" id="L645" title="1 of 2 branches missed.">		if (input_map.get(&quot;maleRadioButton&quot;).equals(&quot;0&quot;)) {</span>
<span class="fc" id="L646">			maleRadioButton.setSelected(true);</span>
		} else {
<span class="nc" id="L648">			femaleRadioButton.setSelected(true);</span>
		}
<span class="fc" id="L650">		startPeriodTextField.setText(input_map.get(&quot;startPeriodTextField&quot;));</span>
<span class="fc" id="L651">		endPeriodTextField.setText(input_map.get(&quot;endPeriodTextField&quot;));</span>
		
<span class="fc" id="L653">		doTask1();</span>
<span class="fc" id="L654">    }</span>

    /**
     * @param inputs
     */
    @FXML
    void rerunTask2(String inputs) {
<span class="nc" id="L661">    	ArrayList&lt;String&gt; elements = new ArrayList&lt;&gt;(Arrays.asList(inputs.split(&quot;;&quot;)));</span>
<span class="nc bnc" id="L662" title="All 2 branches missed.">		for (String element : elements) {</span>
<span class="nc" id="L663">			String str[] = element.split(&quot;:&quot;, 2);</span>
<span class="nc bnc" id="L664" title="All 5 branches missed.">			switch(str[0]) {</span>
				case &quot;task2TextName&quot;:
<span class="nc" id="L666">					task2TextName.setText(str[1]);</span>
<span class="nc" id="L667">					break;</span>
				case &quot;task2RadioMale&quot;:
<span class="nc bnc" id="L669" title="All 2 branches missed.">					if (str[1].equals(&quot;0&quot;)) {</span>
<span class="nc" id="L670">						task2RadioMale.setSelected(true);</span>
					} else {
<span class="nc" id="L672">						task2RadioFemale.setSelected(true);</span>
					}
<span class="nc" id="L674">					break;</span>
				case &quot;task2TextStartPeriod&quot;:
<span class="nc" id="L676">					task2TextStartPeriod.setText(str[1]);</span>
<span class="nc" id="L677">					break;</span>
				case &quot;task2TextEndPeriod&quot;:
<span class="nc" id="L679">					task2TextEndPeriod.setText(str[1]);</span>
<span class="nc" id="L680">					break;</span>
				default:
					break;
			}
<span class="nc" id="L684">		}</span>
<span class="nc" id="L685">		doTask2();</span>
<span class="nc" id="L686">    }</span>

    @FXML
    void rerunTask3(String inputs) {
<span class="nc" id="L690">    	ArrayList&lt;String&gt; input_data = new ArrayList&lt;&gt;(Arrays.asList(inputs.split(&quot;;&quot;)));</span>
<span class="nc" id="L691">		HashMap&lt;String, String&gt; input_map = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L692" title="All 2 branches missed.">		for (String s : input_data) {</span>
<span class="nc" id="L693">			String[] input_pair = s.split(&quot;:&quot;);</span>
<span class="nc" id="L694">			input_map.put(input_pair[0], input_pair[1]);</span>
<span class="nc" id="L695">		}</span>
<span class="nc" id="L696">		task3_year_start.setText(input_map.get(&quot;start_year&quot;));</span>
<span class="nc" id="L697">		task3_year_end.setText(input_map.get(&quot;end_year&quot;));</span>
<span class="nc" id="L698">		t3_topN.setText(input_map.get(&quot;topN&quot;));</span>
<span class="nc bnc" id="L699" title="All 2 branches missed.">		if (input_map.get(&quot;gender&quot;).equals(&quot;M&quot;)) {</span>
<span class="nc" id="L700">			t3_m.setSelected(true);</span>
<span class="nc" id="L701">			t3_f.setSelected(false);</span>
		} else {
<span class="nc" id="L703">			t3_m.setSelected(false);</span>
<span class="nc" id="L704">			t3_f.setSelected(true);</span>
		}
<span class="nc" id="L706">		doTask3();</span>
<span class="nc" id="L707">    }</span>

    @FXML
    void rerunTask4(String inputs) {
<span class="nc" id="L711">    	ArrayList&lt;String&gt; input_data = new ArrayList&lt;&gt;(Arrays.asList(inputs.split(&quot;;&quot;)));</span>
<span class="nc" id="L712">		HashMap&lt;String, String&gt; input_map = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L713" title="All 2 branches missed.">		for (String s : input_data) {</span>
<span class="nc" id="L714">			String[] input_pair = s.split(&quot;:&quot;);</span>
<span class="nc" id="L715">			input_map.put(input_pair[0], input_pair[1]);</span>
<span class="nc" id="L716">		}</span>
		
<span class="nc" id="L718">		t4_dname.setText(input_map.get(&quot;dName&quot;));</span>
<span class="nc" id="L719">    	t4_mname.setText(input_map.get(&quot;mName&quot;));</span>
<span class="nc" id="L720">    	t4_dyob.setText(input_map.get(&quot;dYOB&quot;));</span>
<span class="nc" id="L721">	    t4_myob.setText(input_map.get(&quot;mYOB&quot;));</span>
<span class="nc" id="L722">	    t4_vyear.setText(input_map.get(&quot;vYear&quot;));</span>
	    
<span class="nc bnc" id="L724" title="All 2 branches missed.">	    if(input_map.get(&quot;choice&quot;).equals(&quot;NK-T4&quot;)) {</span>
<span class="nc" id="L725">	    	t4_nkt4.setSelected(true);</span>
<span class="nc" id="L726">	    	t4_jaro.setSelected(false);</span>
	    } else {
<span class="nc" id="L728">	    	t4_nkt4.setSelected(false);</span>
<span class="nc" id="L729">	    	t4_jaro.setSelected(true);</span>
	    }
	    
<span class="nc" id="L732">		doTask4();</span>
<span class="nc" id="L733">    }</span>

    @FXML
    void rerunTask5(String inputs) {
		/*fill in the elements here
		
		*/
<span class="fc" id="L740">		ArrayList&lt;String&gt; input_data = new ArrayList&lt;&gt;(Arrays.asList(inputs.split(&quot;;&quot;)));</span>
<span class="fc" id="L741">		HashMap&lt;String, String&gt; input_map = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L742" title="All 2 branches covered.">		for (String s : input_data) {</span>
<span class="fc" id="L743">			String[] input_pair = s.split(&quot;:&quot;);</span>
<span class="fc" id="L744">			input_map.put(input_pair[0], input_pair[1]);</span>
<span class="fc" id="L745">		}</span>
<span class="fc" id="L746">		app2YourName.setText(input_map.get(&quot;app2YourName&quot;));</span>
<span class="pc bpc" id="L747" title="1 of 2 branches missed.">		if (input_map.get(&quot;app2YourGenderM&quot;).equals(&quot;0&quot;)) {</span>
<span class="nc" id="L748">			app2YourGenderM.setSelected(true);</span>
		} else {
<span class="fc" id="L750">			app2YourGenderF.setSelected(true);</span>
		}
<span class="fc" id="L752">		app2YOB.setText(input_map.get(&quot;app2YOB&quot;));</span>
<span class="pc bpc" id="L753" title="1 of 2 branches missed.">		if (input_map.get(&quot;app2SoulGenderM&quot;).equals(&quot;0&quot;)) {</span>
<span class="nc" id="L754">			app2SoulGenderM.setSelected(true);</span>
		} else {
<span class="fc" id="L756">			app2SoulGenderF.setSelected(true);</span>
		}
<span class="pc bpc" id="L758" title="1 of 2 branches missed.">		if (input_map.get(&quot;app2SoulYounger&quot;).equals(&quot;0&quot;)) {</span>
<span class="nc" id="L759">			app2SoulYounger.setSelected(true);</span>
		} else {
<span class="fc" id="L761">			app2SoulOlder.setSelected(true);</span>
		}
<span class="pc bpc" id="L763" title="1 of 2 branches missed.">		if (input_map.get(&quot;app2RadioNK&quot;).equals(&quot;1&quot;)) {</span>
<span class="fc" id="L764">			app2RadioNK.setSelected(true);</span>
<span class="fc" id="L765">			doTask5();</span>
		} else {
<span class="nc" id="L767">			app2RadioJaro.setSelected(true);</span>
<span class="nc" id="L768">			app2Answer.setText(input_map.get(&quot;chosenName&quot;));</span>
<span class="nc" id="L769">			app2Answer.setVisible(true);</span>
<span class="nc" id="L770">			String query = &quot;Task 5, &quot; + inputs;</span>
	        try {
<span class="nc" id="L772">				History.storeHistory(query);</span>
<span class="nc" id="L773">			} catch (IOException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L775">				e.printStackTrace();</span>
<span class="nc" id="L776">				System.out.println(&quot;Failed to store query history&quot;);</span>
<span class="nc" id="L777">			}</span>
			}
		
<span class="fc" id="L780">    }</span>

    /**
     * @param inputs
     */
    @FXML
    void rerunTask6(String inputs) {
<span class="nc" id="L787">		ArrayList&lt;String&gt; elements = new ArrayList&lt;&gt;(Arrays.asList(inputs.split(&quot;;&quot;)));</span>
<span class="nc bnc" id="L788" title="All 2 branches missed.">		for (String element : elements) {</span>
<span class="nc" id="L789">			String str[] = element.split(&quot;:&quot;, 2);</span>
<span class="nc bnc" id="L790" title="All 9 branches missed.">			switch(str[0]) {</span>
				case &quot;task6TextName1&quot;:
<span class="nc" id="L792">					task6TextName1.setText(str[1]);</span>
<span class="nc" id="L793">					break;</span>
				case &quot;task6Toggle1&quot;:
<span class="nc bnc" id="L795" title="All 2 branches missed.">					if (str[1].equals(&quot;0&quot;)) {</span>
<span class="nc" id="L796">						task6RadioMale1.setSelected(true);</span>
					} else {
<span class="nc" id="L798">						task6RadioFemale1.setSelected(true);</span>
					}
<span class="nc" id="L800">					break;</span>
				case &quot;task6TextYear1&quot;:
<span class="nc" id="L802">					task6TextYear1.setText(str[1]);</span>
<span class="nc" id="L803">					break;</span>
				case &quot;task6TextName2&quot;:
<span class="nc" id="L805">					task6TextName2.setText(str[1]);</span>
<span class="nc" id="L806">					break;</span>
				case &quot;task6Toggle2&quot;:
<span class="nc bnc" id="L808" title="All 2 branches missed.">					if (str[1].equals(&quot;0&quot;)) {</span>
<span class="nc" id="L809">						task6RadioMale2.setSelected(true);</span>
					} else {
<span class="nc" id="L811">						task6RadioFemale2.setSelected(true);</span>
					}
<span class="nc" id="L813">					break;</span>
				case &quot;task6Toggle3&quot;:
<span class="nc bnc" id="L815" title="All 2 branches missed.">					if (str[1].equals(&quot;0&quot;)) {</span>
<span class="nc" id="L816">						task6RadioYounger.setSelected(true);</span>
<span class="nc bnc" id="L817" title="All 2 branches missed.">					} else if (str[1].equals(&quot;1&quot;)) {</span>
<span class="nc" id="L818">						task6RadioOlder.setSelected(true);</span>
					} else {
<span class="nc" id="L820">						task6RadioCustom.setSelected(true);</span>
					}
<span class="nc" id="L822">					break;</span>
				case &quot;task6TextYear2&quot;:
<span class="nc" id="L824">					task6TextYear2.setText(str[1]);</span>
<span class="nc" id="L825">					break;</span>
				case &quot;task6Toggle4&quot;:
<span class="nc bnc" id="L827" title="All 2 branches missed.">					if (str[1].equals(&quot;0&quot;)) {</span>
<span class="nc" id="L828">						task6RadioNKT6.setSelected(true);</span>
<span class="nc bnc" id="L829" title="All 2 branches missed.">					} else if (str[1].equals(&quot;1&quot;)) {</span>
<span class="nc" id="L830">						task6RadioNorm.setSelected(true);</span>
					} else {
<span class="nc" id="L832">						task6RadioLinear.setSelected(true);</span>
					}
<span class="nc" id="L834">					break;</span>
				default:
					break;
			}
<span class="nc" id="L838">		}</span>
<span class="nc" id="L839">		doTask6();</span>
<span class="nc" id="L840">    }</span>

        
    /**
     *  Task One
     *  To be triggered by the Generate Report Button in Reporting 1 tab.
     *  
     */
    @FXML
    void doTask1() {
        int numRanks;
        int startPeriod;
        int endPeriod;
        int gender;
        try {
            // input validation and catches any errors
<span class="fc" id="L856">                numRanks = Integer.parseInt(numRankTextField.getText());</span>
<span class="fc" id="L857">                startPeriod = Integer.parseInt(startPeriodTextField.getText());</span>
<span class="fc" id="L858">                endPeriod = Integer.parseInt(endPeriodTextField.getText());</span>
                
<span class="pc bpc" id="L860" title="1 of 2 branches missed.">            if (maleRadioButton.isSelected()) {</span>
<span class="fc" id="L861">                gender = 0;</span>
            } else {
<span class="nc" id="L863">                gender = 1;</span>
            }
            
<span class="fc" id="L866">        } catch(NumberFormatException e) {</span>
            // some error catching here
<span class="fc" id="L868">        	showWarning(&quot;Invalid Input Format&quot;, &quot;Please only enter numbers.&quot;);</span>
<span class="fc" id="L869">            return;</span>
<span class="fc" id="L870">        }</span>
<span class="fc bfc" id="L871" title="All 2 branches covered.">        if (!Activity1Query.isNumOfResultsCorrect(numRanks)) {</span>
<span class="fc" id="L872">        	showWarning(&quot;Invalid Input&quot;, &quot;Please enter an N that is &gt;= 1. &quot;);</span>
<span class="fc" id="L873">        	return;</span>
        }
<span class="fc bfc" id="L875" title="All 2 branches covered.">        if (!Activity1Query.isPeriodCorrect(startPeriod, endPeriod)) {</span>
<span class="fc" id="L876">        	showWarning(&quot;Invalid Input&quot;, &quot;Start and End periods must be within the boundaries stated.&quot;);</span>
<span class="fc" id="L877">        	return;</span>
        }
        
<span class="fc" id="L880">        ArrayList&lt;YearRecords&gt; yearRecordsList = Activity1Query.executeQuery(numRanks, gender, startPeriod, endPeriod);</span>
        // clear all the contents of the table view &amp; bar chart
<span class="fc" id="L882">        report1Table.getColumns().clear();</span>
<span class="fc" id="L883">        report1Table.getItems().clear();</span>
<span class="fc" id="L884">        report1Table.refresh();</span>
<span class="fc" id="L885">        rep1BarChart.getData().clear();</span>
<span class="fc" id="L886">        rep1BarChart.setVisible(true);</span>

        // initializing the year column
<span class="fc" id="L889">        TableColumn&lt;Map,String&gt; yearColumn = new TableColumn&lt;&gt;(&quot;Year&quot;);</span>
<span class="fc" id="L890">        yearColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;year&quot;));</span>
<span class="fc" id="L891">        report1Table.getColumns().add(yearColumn);</span>
        
<span class="fc" id="L893">        int index = 1;</span>
<span class="fc bfc" id="L894" title="All 2 branches covered.">        for (; index &lt;= numRanks; index++) {</span>
<span class="fc" id="L895">            TableColumn&lt;Map, String&gt; topColumn = new TableColumn&lt;&gt;(&quot;Top &quot; + index);</span>
<span class="fc" id="L896">            topColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;top&quot; + index));</span>
<span class="fc" id="L897">            report1Table.getColumns().add(topColumn);</span>
        }
        ObservableList&lt;Map&lt;String, Object&gt;&gt; items =
<span class="fc" id="L900">                FXCollections.&lt;Map&lt;String, Object&gt;&gt;observableArrayList();</span>

<span class="fc bfc" id="L902" title="All 2 branches covered.">        for (YearRecords y : yearRecordsList) {</span>
<span class="fc" id="L903">            Map&lt;String, Object&gt; item = new HashMap&lt;&gt;();</span>
<span class="fc" id="L904">            item.put(&quot;year&quot;, y.getYear());</span>
<span class="fc" id="L905">            index = 1;</span>
<span class="fc bfc" id="L906" title="All 2 branches covered.">            for (NameRecord nr : y.getNameRecordList()) {</span>
<span class="fc" id="L907">                item.put(&quot;top&quot; + index, nr.getName());</span>
<span class="fc" id="L908">                index++;</span>
<span class="fc" id="L909">            }</span>
<span class="fc" id="L910">            items.add(item);</span>
<span class="fc" id="L911">        }</span>
<span class="fc" id="L912">        report1Table.getItems().addAll(items);</span>
        
        // display bar chart with info. 
<span class="fc" id="L915">        rep1BarChart.setVisible(true);</span>
<span class="fc" id="L916">        LinkedHashMap&lt;String, Integer&gt; top3Names = Activity1Query.top3Names;</span>
        
<span class="fc" id="L918">        XYChart.Series&lt;String, Integer&gt; dataSeries = new XYChart.Series&lt;String, Integer&gt;();</span>
<span class="fc" id="L919">        dataSeries.setName(Integer.toString(startPeriod) + &quot; - &quot; + Integer.toString(endPeriod));</span>
<span class="fc bfc" id="L920" title="All 2 branches covered.">        for (Entry&lt;String, Integer&gt; entry : top3Names.entrySet())</span>
        {
<span class="fc" id="L922">            dataSeries.getData().add(new XYChart.Data&lt;String, Integer&gt;(entry.getKey(), entry.getValue()));</span>
            
<span class="fc" id="L924">        }</span>
<span class="fc" id="L925">        rep1BarChart.getData().add(dataSeries);</span>
<span class="fc" id="L926">        rep1Comment.setVisible(true);</span>
<span class="fc" id="L927">        rep1Comment.setText(Activity1Query.comment);</span>
<span class="fc" id="L928">        rep1Label.setVisible(true);</span>
        
        
        
<span class="fc" id="L932">    }</span>

    /**
     *  Task Two
     *  To be triggered by the Generate Report Button in Reporting 2 tab.
     *  
     */
    @FXML
    void doTask2() {
        String name;
        int gender;
        int startPeriod;
        int endPeriod;
<span class="fc" id="L945">        name = task2TextName.getText();</span>
<span class="fc bfc" id="L946" title="All 2 branches covered.">        if(name.equals(&quot;&quot;)){</span>
<span class="fc" id="L947">            showWarning(&quot;Invalid Name&quot;, &quot;Please enter a name.&quot;);</span>
<span class="fc" id="L948">            return;</span>
        }
        try {
<span class="fc" id="L951">            startPeriod = Integer.parseInt(task2TextStartPeriod.getText());</span>
<span class="fc" id="L952">            endPeriod = Integer.parseInt(task2TextEndPeriod.getText());</span>
<span class="fc" id="L953">        } catch(NumberFormatException e) {</span>
<span class="fc" id="L954">            showWarning(&quot;Invalid Period&quot;, &quot;Period must be integers.&quot;);</span>
<span class="fc" id="L955">            return;</span>
<span class="fc" id="L956">        }      </span>
<span class="fc bfc" id="L957" title="All 2 branches covered.">        if (task2RadioMale.isSelected()) {</span>
<span class="fc" id="L958">            gender = 0;</span>
        } else {
<span class="fc" id="L960">            gender = 1;</span>
        }
        Pair&lt;ArrayList&lt;RankRecord&gt;, String&gt; queryResult;
        try {
<span class="fc" id="L964">            queryResult = Activity2Query.executeQuery(name, gender, startPeriod, endPeriod);</span>
<span class="fc" id="L965">        } catch(RuntimeException e) {</span>
<span class="fc bfc" id="L966" title="All 2 branches covered.">            if(e.getMessage().equals(&quot;length&quot;)) {</span>
<span class="fc" id="L967">                showWarning(&quot;Invalid Name&quot;, &quot;Name must contain only 2 to 15 characters.&quot;);</span>
<span class="fc bfc" id="L968" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;char&quot;)) {</span>
<span class="fc" id="L969">                showWarning(&quot;Invalid Name&quot;, &quot;Name must contain only letters.&quot;);</span>
<span class="fc bfc" id="L970" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;start&quot;)) {</span>
<span class="fc" id="L971">                showWarning(&quot;Invalid Period&quot;, &quot;Starting year must be an integer between 1880 and 2019.&quot;);</span>
<span class="fc bfc" id="L972" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;end&quot;)) {</span>
<span class="fc" id="L973">                showWarning(&quot;Invalid Period&quot;, &quot;Ending year must be an integer between 1880 and 2019.&quot;);</span>
            } else { // if(e.getMessage().equals(&quot;startend&quot;)) {
<span class="fc" id="L975">                showWarning(&quot;Invalid Period&quot;, &quot;Both starting and ending years must be integers between 1880 and 2019.&quot;);</span>
            }
<span class="fc" id="L977">            return;</span>
<span class="fc" id="L978">        }</span>
<span class="fc" id="L979">        ArrayList&lt;RankRecord&gt; rankRecords = queryResult.getKey();</span>

<span class="fc" id="L981">        task2TextResult.setText(queryResult.getValue());</span>

<span class="fc" id="L983">        task2TableResult.getItems().clear();</span>
<span class="fc" id="L984">        ObservableList&lt;Map&lt;String, Object&gt;&gt; items = FXCollections.&lt;Map&lt;String, Object&gt;&gt;observableArrayList();</span>

<span class="fc" id="L986">        task2LineChartResult.getData().clear();</span>
<span class="fc" id="L987">        XYChart.Series&lt;Integer, Number&gt; series = new XYChart.Series&lt;&gt;();</span>
<span class="fc" id="L988">        series.setName(name);</span>
        
<span class="fc" id="L990">        DecimalFormat df = new DecimalFormat(&quot;0&quot;);</span>
<span class="fc" id="L991">        df.setMaximumFractionDigits(340);</span>
<span class="fc bfc" id="L992" title="All 2 branches covered.">        for (RankRecord record : rankRecords) {</span>
<span class="fc" id="L993">            Map&lt;String, Object&gt; item = new HashMap&lt;&gt;();</span>
<span class="fc" id="L994">            item.put(&quot;year&quot;, record.getYear());</span>
<span class="fc bfc" id="L995" title="All 2 branches covered.">            if(record.isValid()) {</span>
<span class="fc" id="L996">                item.put(&quot;rank&quot;, record.getRank());</span>
<span class="fc" id="L997">                item.put(&quot;count&quot;, record.getCount());</span>
<span class="fc" id="L998">                item.put(&quot;percentage&quot;, df.format(AnalyzeNames.round(record.getPercentage() * 100, 5)) + &quot;%&quot;);</span>
<span class="fc" id="L999">                series.getData().add(new XYChart.Data&lt;&gt;(record.getYear(), record.getPercentage() * 100));</span>
            } else {
<span class="fc" id="L1001">                item.put(&quot;rank&quot;, &quot;NULL&quot;);</span>
<span class="fc" id="L1002">                item.put(&quot;count&quot;, &quot;NULL&quot;);</span>
<span class="fc" id="L1003">                item.put(&quot;percentage&quot;, &quot;NULL&quot;);</span>
            }            
<span class="fc" id="L1005">            items.add(item);</span>
<span class="fc" id="L1006">        }</span>
<span class="fc" id="L1007">        task2TableResult.getItems().addAll(items);</span>
        
<span class="fc" id="L1009">        task2LineChartResult.getData().add(series);</span>
<span class="fc" id="L1010">    }</span>
    
    /**
     *  Task Three
     *  To be triggered by the Generate Report Button in Reporting 3 tab.
     *  
     */
    @FXML
    void doTask3() {
<span class="fc" id="L1019">    	task3_table.getColumns().clear();</span>
<span class="fc" id="L1020">    	task3_table.getItems().clear();</span>
<span class="fc" id="L1021">    	task3_table.refresh();</span>
    	
    	int year_start;
    	int year_end;
    	int topN;
    	
    	try {
<span class="fc" id="L1028">    		year_start = Integer.parseInt(task3_year_start.getText());</span>
<span class="fc" id="L1029">        	year_end = Integer.parseInt(task3_year_end.getText());</span>
        	
<span class="nc" id="L1031">        } catch(NumberFormatException e) {</span>
<span class="nc" id="L1032">            showWarning(&quot;Invalid Period&quot;, &quot;Period must be integers.&quot;);</span>
<span class="nc" id="L1033">            return;</span>
<span class="fc" id="L1034">        }   </span>
    	try {
<span class="fc" id="L1036">    		topN = Integer.parseInt(t3_topN.getText());</span>
<span class="nc" id="L1037">        } catch(NumberFormatException e) {</span>
<span class="nc" id="L1038">            showWarning(&quot;Invalid Entry&quot;, &quot;Top N must be an integer&quot;);</span>
<span class="nc" id="L1039">            return;</span>
<span class="fc" id="L1040">        } </span>
    	
<span class="fc" id="L1042">    	String gender = &quot;&quot;;</span>
<span class="pc bpc" id="L1043" title="1 of 2 branches missed.">    	if (this.T3_toggle_group.getSelectedToggle().equals(this.t3_m)) {</span>
<span class="nc" id="L1044">    		gender = &quot;M&quot;;</span>
    	}
<span class="pc bpc" id="L1046" title="1 of 2 branches missed.">    	else if (this.T3_toggle_group.getSelectedToggle().equals(this.t3_f)) {</span>
<span class="fc" id="L1047">    		gender = &quot;F&quot;;</span>
    	}
    	ArrayList&lt;ArrayList&lt;String&gt;&gt; Report;
    	
    	try {
<span class="fc" id="L1052">    		Report = Task3.execute3Query(year_start, year_end, gender, topN);</span>
<span class="fc" id="L1053">        } catch(RuntimeException e) {</span>
<span class="fc bfc" id="L1054" title="All 2 branches covered.">            if(e.getMessage().equals(&quot;start&quot;)) {</span>
<span class="fc" id="L1055">                showWarning(&quot;Invalid Period&quot;, &quot;Starting year must be an integer between 1880 and 2019.&quot;);</span>
<span class="fc bfc" id="L1056" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;end&quot;)) {</span>
<span class="fc" id="L1057">                showWarning(&quot;Invalid Period&quot;, &quot;Ending year must be an integer between 1880 and 2019.&quot;);</span>
<span class="fc bfc" id="L1058" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;start end&quot;)) {</span>
<span class="fc" id="L1059">                showWarning(&quot;Invalid Period&quot;, &quot;Both starting and ending years must be integers between 1880 and 2019.&quot;);</span>
<span class="fc bfc" id="L1060" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;incorrect period order&quot;)) {</span>
<span class="fc" id="L1061">            	showWarning(&quot;Invalid Period&quot;, &quot;Starting year is ahead of Ending year&quot;);</span>
<span class="pc bpc" id="L1062" title="1 of 2 branches missed.">            } else if(e.getMessage().equals(&quot;incorrect TopN&quot;)) {</span>
<span class="fc" id="L1063">            	showWarning(&quot;Invalid Entry&quot;, &quot;TopN must be &gt;= 1&quot;);</span>
            }
<span class="fc" id="L1065">            return;</span>
<span class="fc" id="L1066">        }</span>
    	
<span class="fc" id="L1068">    	TableColumn&lt;Map,String&gt; nameColumn = new TableColumn&lt;&gt;(&quot;Name&quot;);</span>
<span class="fc" id="L1069">    	nameColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;name&quot;));</span>
<span class="fc" id="L1070">        task3_table.getColumns().add(nameColumn);</span>
        
<span class="fc" id="L1072">        TableColumn&lt;Map, String&gt; lrYear = new TableColumn&lt;&gt;(&quot;low rank year&quot;);</span>
<span class="fc" id="L1073">        lrYear.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;lrYear&quot;));</span>
<span class="fc" id="L1074">        task3_table.getColumns().add(lrYear);</span>

<span class="fc" id="L1076">        TableColumn&lt;Map, String&gt; lr = new TableColumn&lt;&gt;(&quot;low rank&quot;);</span>
<span class="fc" id="L1077">        lr.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;lr&quot;));</span>
<span class="fc" id="L1078">        task3_table.getColumns().add(lr);</span>

<span class="fc" id="L1080">        TableColumn&lt;Map, String&gt; hrYear = new TableColumn&lt;&gt;(&quot;high rank year&quot;);</span>
<span class="fc" id="L1081">        hrYear.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;hrYear&quot;));</span>
<span class="fc" id="L1082">        task3_table.getColumns().add(hrYear);</span>
        
<span class="fc" id="L1084">        TableColumn&lt;Map, String&gt; hr = new TableColumn&lt;&gt;(&quot;high rank&quot;);</span>
<span class="fc" id="L1085">        hr.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;hr&quot;));</span>
<span class="fc" id="L1086">        task3_table.getColumns().add(hr);</span>
        
<span class="fc" id="L1088">        TableColumn&lt;Map, String&gt; trendColumn = new TableColumn&lt;&gt;(&quot;Trend&quot;);</span>
<span class="fc" id="L1089">        trendColumn.setCellValueFactory(new MapValueFactory&lt;&gt;(&quot;trend&quot;));</span>
<span class="fc" id="L1090">        task3_table.getColumns().add(trendColumn);</span>
        
<span class="fc" id="L1092">        ObservableList&lt;Map&lt;String, Object&gt;&gt; items = FXCollections.&lt;Map&lt;String, Object&gt;&gt;observableArrayList();</span>
        
<span class="fc bfc" id="L1094" title="All 2 branches covered.">        for (ArrayList&lt;String&gt; record : Report) {</span>
<span class="fc" id="L1095">            Map&lt;String, Object&gt; item = new HashMap&lt;&gt;();</span>
<span class="fc" id="L1096">            item.put(&quot;name&quot;, record.get(0));</span>
<span class="fc" id="L1097">            item.put(&quot;lrYear&quot;, record.get(1));</span>
<span class="fc" id="L1098">            item.put(&quot;lr&quot;, record.get(2));</span>
<span class="fc" id="L1099">            item.put(&quot;hrYear&quot;, record.get(3));</span>
<span class="fc" id="L1100">            item.put(&quot;hr&quot;, record.get(4));</span>
<span class="fc" id="L1101">            item.put(&quot;trend&quot;, record.get(5));    </span>
<span class="fc" id="L1102">            items.add(item);</span>
<span class="fc" id="L1103">        }</span>
<span class="fc" id="L1104">        task3_table.getItems().addAll(items);</span>
    	
<span class="fc" id="L1106">    }</span>
    
    /**
     *  Task Four
     *  To be triggered by the Get Recommendation in Reporting 4 tab.
     *  
     */
    @FXML
    void doTask4() {
<span class="fc" id="L1115">    	String dName = t4_dname.getText();</span>
<span class="fc" id="L1116">    	String mName = t4_mname.getText();</span>
    	int dYOB;
    	int mYOB;
    	int vYear;
    	try {
<span class="fc" id="L1121">	    	dYOB = Integer.parseInt(t4_dyob.getText());</span>
<span class="fc" id="L1122">	    	mYOB = Integer.parseInt(t4_myob.getText());</span>
<span class="fc" id="L1123">	    	vYear = Integer.parseInt(t4_vyear.getText());</span>
<span class="fc" id="L1124">    	} catch(NumberFormatException e) {</span>
<span class="fc" id="L1125">            showWarning(&quot;Invalid Entry&quot;, &quot;Period must be an integer&quot;);</span>
<span class="fc" id="L1126">            return;</span>
<span class="fc" id="L1127">        } </span>
<span class="fc" id="L1128">    	String choice = &quot;&quot;;</span>
<span class="fc bfc" id="L1129" title="All 2 branches covered.">    	if (this.T4_algorithm.getSelectedToggle().equals(this.t4_nkt4)){</span>
<span class="fc" id="L1130">    		choice = &quot;NK-T4&quot;;</span>
    	}
<span class="pc bpc" id="L1132" title="1 of 2 branches missed.">    	else if (this.T4_algorithm.getSelectedToggle().equals(this.t4_jaro)) {</span>
<span class="fc" id="L1133">    		choice = &quot;Jaro&quot;;</span>
    	}
    	
<span class="fc" id="L1136">    	ArrayList&lt;ArrayList&lt;String&gt;&gt; Report = new ArrayList&lt;ArrayList&lt;String&gt;&gt; ();</span>
    	try {
<span class="fc" id="L1138">    		Report = Task4.recommendation(dName, dYOB, mName, mYOB, vYear, choice);</span>
<span class="nc" id="L1139">    	}  catch(RuntimeException e) {</span>
<span class="nc bnc" id="L1140" title="All 2 branches missed.">    		if(e.getMessage().equals(&quot;invalid dYOB&quot;)) {</span>
<span class="nc" id="L1141">                showWarning(&quot;Invalid Period&quot;, &quot;Dad Year of Birth must be in range 1880 - 2019&quot;);</span>
<span class="nc bnc" id="L1142" title="All 2 branches missed.">            } else if(e.getMessage().equals(&quot;invalid mYOB&quot;)) {</span>
<span class="nc" id="L1143">                showWarning(&quot;Invalid Period&quot;, &quot;Mom Year of Birth must be in range 1880 - 2019&quot;);</span>
<span class="nc bnc" id="L1144" title="All 2 branches missed.">            } else if(e.getMessage().equals(&quot;invalid vYear&quot;)) {</span>
<span class="nc" id="L1145">                showWarning(&quot;Invalid Period&quot;, &quot;Vintage Year must be in range 1880 - 2019&quot;);</span>
<span class="nc bnc" id="L1146" title="All 2 branches missed.">            } else if(e.getMessage().equals(&quot;dName length&quot;)) {</span>
<span class="nc" id="L1147">                showWarning(&quot;Invalid Name&quot;, &quot;Dad's name must be 2 to 15 characters long.&quot;);</span>
<span class="nc bnc" id="L1148" title="All 2 branches missed.">            } else if(e.getMessage().equals(&quot;mName length&quot;)) {</span>
<span class="nc" id="L1149">                showWarning(&quot;Invalid Name&quot;, &quot;Mom's name must be 2 to 15 characters long.&quot;);</span>
<span class="nc bnc" id="L1150" title="All 2 branches missed.">            } else if(e.getMessage().equals(&quot;dName char&quot;)) {</span>
<span class="nc" id="L1151">                showWarning(&quot;Invalid Name&quot;, &quot;Dad's name has invalid characters&quot;);</span>
<span class="nc bnc" id="L1152" title="All 2 branches missed.">            } else if(e.getMessage().equals(&quot;mName char&quot;)) {</span>
<span class="nc" id="L1153">                showWarning(&quot;Invalid Name&quot;, &quot;Mom's name has invalid characters&quot;);</span>
            }
<span class="fc" id="L1155">    	}</span>
<span class="fc bfc" id="L1156" title="All 2 branches covered.">    	if(choice == &quot;NK-T4&quot;) {</span>
<span class="fc" id="L1157">    		t4_boy_label.setText(&quot;Boy names&quot;);</span>
<span class="fc" id="L1158">    		t4_girl_label.setText(&quot;Girl names&quot;);</span>
<span class="fc" id="L1159">    		t4_b1.setText(Report.get(0).get(0));</span>
<span class="fc" id="L1160">    		t4_g1.setText(Report.get(1).get(0));</span>
    	} else {
<span class="fc" id="L1162">    		t4_boy_label.setText(&quot;Boy names and scores&quot;);</span>
<span class="fc" id="L1163">    		t4_girl_label.setText(&quot;Girl names and scores&quot;);</span>
<span class="fc" id="L1164">    		t4_b1.setText(Report.get(0).get(0));</span>
<span class="fc" id="L1165">    		t4_b2.setText(Report.get(0).get(1));</span>
<span class="fc" id="L1166">    		t4_b3.setText(Report.get(0).get(2));</span>
<span class="fc" id="L1167">    		t4_g1.setText(Report.get(1).get(0));</span>
<span class="fc" id="L1168">    		t4_g2.setText(Report.get(1).get(1));</span>
<span class="fc" id="L1169">    		t4_g3.setText(Report.get(1).get(2));</span>
    	}
<span class="fc" id="L1171">    }</span>
    
    
    /**
     *  Task Five
     *  To be triggered by the Generate Report Button in Application 2 tab.
     *  
     */
    @FXML
    void doTask5() {
        String name;
        int gender;
        int prefGender;
        int yob;
        boolean prefYounger;
        try {
            // get data from input fields
<span class="fc" id="L1188">            name = app2YourName.getText();</span>
<span class="fc" id="L1189">            yob = Integer.parseInt(app2YOB.getText());</span>
<span class="fc bfc" id="L1190" title="All 2 branches covered.">            if (app2YourGenderM.isSelected()) {</span>
<span class="fc" id="L1191">                gender = 0;</span>
            } else {
<span class="fc" id="L1193">                gender = 1;</span>
            }
<span class="pc bpc" id="L1195" title="1 of 2 branches missed.">            if (app2SoulGenderM.isSelected()) {</span>
<span class="nc" id="L1196">                prefGender = 0;</span>
            } else {
<span class="fc" id="L1198">                prefGender = 1;</span>
            }
<span class="fc" id="L1200">            prefYounger = app2SoulYounger.isSelected();</span>
            // input validation
<span class="fc bfc" id="L1202" title="All 2 branches covered.">            if (!Activity5Query.isNameCorrect(name)) {</span>
<span class="fc" id="L1203">            	showWarning(&quot;Invalid Input&quot;, &quot;Please only enter letters for your name.&quot;);</span>
<span class="fc" id="L1204">                return;</span>
            } 
<span class="fc bfc" id="L1206" title="All 2 branches covered.">            if (!Activity5Query.isYOBCorrect(yob)){</span>
<span class="fc" id="L1207">            	showWarning(&quot;Invalid Input&quot;, &quot;Please only enter year of births that are within the boundaries stated.&quot;);</span>
<span class="fc" id="L1208">            	return;</span>
            }
<span class="pc bpc" id="L1210" title="1 of 2 branches missed.">            if ( !AnalyzeNames.checkNameLength(name)) {</span>
<span class="nc" id="L1211">            	showWarning(&quot;Invalid Input&quot;, &quot;Please only enter names of length less than 16 characters.&quot;);</span>
<span class="nc" id="L1212">            	return;</span>
            }
            
<span class="fc" id="L1215">        } catch(NumberFormatException e) {</span>
            //error catching logic here
<span class="fc" id="L1217">        	showWarning(&quot;Invalid Input Format&quot;, &quot;Please only enter numbers for YOB.&quot;);</span>
<span class="fc" id="L1218">            return;</span>
<span class="fc" id="L1219">        }</span>
<span class="fc" id="L1220">        String oName = &quot;undefined&quot;;</span>
<span class="fc bfc" id="L1221" title="All 2 branches covered.">        if(app2RadioNK.isSelected()) {</span>
<span class="fc" id="L1222">            oName = Activity5Query.executeQueryNKT5( name, yob, gender, prefGender, prefYounger);</span>
<span class="fc" id="L1223">            app2Answer.setText(oName);</span>
<span class="fc" id="L1224">            app2Answer.setVisible(true);</span>
        }else {
<span class="fc" id="L1226">        	ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L1227">        	list = Activity5Query.executeQueryJaroStepOne(name, yob, gender, prefGender, prefYounger);</span>
<span class="fc" id="L1228">        	app2Button.setDisable(true);</span>
<span class="fc" id="L1229">        	step2Button.setVisible(true);</span>
<span class="fc" id="L1230">        	step2Radio1.setText(list.get(0));</span>
<span class="fc" id="L1231">        	step2Radio2.setText(list.get(1));</span>
<span class="fc" id="L1232">        	step2Radio3.setText(list.get(2));</span>
<span class="fc" id="L1233">        	step2Radio4.setText(list.get(3));</span>
<span class="fc" id="L1234">        	step2Radio5.setText(list.get(4));</span>
<span class="fc" id="L1235">        	step2Radio6.setText(list.get(5));  </span>
<span class="fc" id="L1236">        	step2Radio1.setVisible(true);</span>
<span class="fc" id="L1237">        	step2Radio2.setVisible(true);</span>
<span class="fc" id="L1238">        	step2Radio3.setVisible(true);</span>
<span class="fc" id="L1239">        	step2Radio4.setVisible(true);</span>
<span class="fc" id="L1240">        	step2Radio5.setVisible(true);</span>
<span class="fc" id="L1241">        	step2Radio6.setVisible(true);</span>
<span class="fc" id="L1242">        	step2Label.setVisible(true);</span>
<span class="fc" id="L1243">        	step2Cover.setVisible(true);</span>
<span class="fc" id="L1244">        	app2Answer.setVisible(false);</span>
        }

<span class="fc" id="L1247">    }</span>

    @FXML
    void doTask5Part2() {
        String name;
        int gender;
        int prefGender;
        int yob;
        boolean prefYounger;
<span class="fc" id="L1256">        String oName = &quot;undefined&quot;;</span>
    	
<span class="fc" id="L1258">        name = app2YourName.getText();</span>
<span class="fc" id="L1259">        yob = Integer.parseInt(app2YOB.getText());</span>
<span class="fc" id="L1260">        prefYounger = app2SoulYounger.isSelected();</span>
<span class="pc bpc" id="L1261" title="1 of 2 branches missed.">        if (app2YourGenderM.isSelected()) {</span>
<span class="fc" id="L1262">            gender = 0;</span>
        } else {
<span class="nc" id="L1264">            gender = 1;</span>
        }
<span class="pc bpc" id="L1266" title="1 of 2 branches missed.">        if (app2SoulGenderM.isSelected()) {</span>
<span class="nc" id="L1267">            prefGender = 0;</span>
        } else {
<span class="fc" id="L1269">            prefGender = 1;</span>
        }
    	String chosenName;
<span class="pc bpc" id="L1272" title="1 of 2 branches missed.">        if (step2Radio1.isSelected()) {</span>
<span class="nc" id="L1273">        	chosenName = step2Radio1.getText();</span>
<span class="pc bpc" id="L1274" title="1 of 2 branches missed.">        } else if(step2Radio2.isSelected()) {</span>
<span class="nc" id="L1275">        	chosenName = step2Radio2.getText();</span>
<span class="pc bpc" id="L1276" title="1 of 2 branches missed.">        } else if(step2Radio3.isSelected()) {</span>
<span class="nc" id="L1277">        	chosenName = step2Radio2.getText();</span>
<span class="pc bpc" id="L1278" title="1 of 2 branches missed.">        } else if(step2Radio4.isSelected()) {</span>
<span class="fc" id="L1279">        	chosenName = step2Radio2.getText();</span>
<span class="nc bnc" id="L1280" title="All 2 branches missed.">        }  else if(step2Radio5.isSelected()) {</span>
<span class="nc" id="L1281">        	chosenName = step2Radio2.getText();</span>
        } else  {
<span class="nc" id="L1283">        	chosenName = step2Radio6.getText();</span>
        }
        
        
<span class="fc" id="L1287">        oName = Activity5Query.executeQueryJaroStepTwo( chosenName, name, gender, yob, prefYounger, prefGender);</span>
    	//clean up
<span class="fc" id="L1289">    	step2Radio1.setVisible(false);</span>
<span class="fc" id="L1290">    	step2Radio2.setVisible(false);</span>
<span class="fc" id="L1291">    	step2Radio3.setVisible(false);</span>
<span class="fc" id="L1292">    	step2Radio4.setVisible(false);</span>
<span class="fc" id="L1293">    	step2Radio5.setVisible(false);</span>
<span class="fc" id="L1294">    	step2Radio6.setVisible(false);</span>
<span class="fc" id="L1295">    	step2Button.setVisible(false);</span>
<span class="fc" id="L1296">    	app2Button.setDisable(false);</span>
<span class="fc" id="L1297">    	step2Cover.setVisible(false);</span>
<span class="fc" id="L1298">    	step2Label.setVisible(false);</span>
<span class="fc" id="L1299">        app2Answer.setText(oName);</span>
<span class="fc" id="L1300">        app2Answer.setVisible(true);</span>
<span class="fc" id="L1301">    }</span>

    /**
     *  Task Six
     *  To be triggered by the Generate Report Button in Reporting 2 tab.
     *  
     */
    @FXML
    void doTask6() {
        String name1, name2;
        int gender1, gender2;
        int year1, year2;
<span class="fc" id="L1313">        boolean isYounger = true;</span>
<span class="fc" id="L1314">        name1 = task6TextName1.getText();</span>
<span class="fc" id="L1315">        name2 = task6TextName2.getText();</span>
<span class="fc bfc" id="L1316" title="All 2 branches covered.">        if(name1.equals(&quot;&quot;)){</span>
<span class="fc" id="L1317">            showWarning(&quot;Invalid Name&quot;, &quot;Please enter your name.&quot;);</span>
<span class="fc" id="L1318">            return;</span>
        }
<span class="fc bfc" id="L1320" title="All 2 branches covered.">        if (task6RadioMale1.isSelected()) {</span>
<span class="fc" id="L1321">            gender1 = 0;</span>
        } else {
<span class="fc" id="L1323">            gender1 = 1;</span>
        }
        try {
<span class="fc" id="L1326">            year1 = Integer.parseInt(task6TextYear1.getText());</span>
<span class="fc" id="L1327">        } catch(NumberFormatException e) {</span>
<span class="fc" id="L1328">            showWarning(&quot;Invalid Year of Birth&quot;, &quot;Your year of birth must be an integer.&quot;);</span>
<span class="fc" id="L1329">            return;</span>
<span class="fc" id="L1330">        }</span>
<span class="fc bfc" id="L1331" title="All 2 branches covered.">        if(name2.equals(&quot;&quot;)){</span>
<span class="fc" id="L1332">            showWarning(&quot;Invalid Name&quot;, &quot;Please enter the name of your soulmate.&quot;);</span>
<span class="fc" id="L1333">            return;</span>
        }
<span class="fc bfc" id="L1335" title="All 2 branches covered.">        if (task6RadioMale2.isSelected()) {</span>
<span class="fc" id="L1336">            gender2 = 0;</span>
        } else {
<span class="fc" id="L1338">            gender2 = 1;</span>
        }
<span class="fc bfc" id="L1340" title="All 2 branches covered.">        if (task6RadioYounger.isSelected()) {</span>
<span class="fc" id="L1341">            isYounger = true;</span>
<span class="fc bfc" id="L1342" title="All 2 branches covered.">            year2 = year1 == 2019 ? 2019 : year1 + 1;</span>
<span class="fc bfc" id="L1343" title="All 2 branches covered.">        } else if (task6RadioOlder.isSelected()) {</span>
<span class="fc" id="L1344">            isYounger = false;</span>
<span class="fc bfc" id="L1345" title="All 2 branches covered.">            year2 = year1 == 1880 ? 1880 : year1 - 1;</span>
        } else {
<span class="fc bfc" id="L1347" title="All 4 branches covered.">            if (task6RadioNKT6.isSelected() || task6RadioNorm.isSelected()) {</span>
<span class="fc" id="L1348">                showWarning(&quot;Invalid Preference&quot;, &quot;Either Younger or Older must be chosen for NK-T6 algorithms.&quot;);</span>
<span class="fc" id="L1349">                return;</span>
            }
            try {
<span class="fc" id="L1352">                year2 = Integer.parseInt(task6TextYear2.getText());</span>
<span class="fc" id="L1353">            } catch(NumberFormatException e) {</span>
<span class="fc" id="L1354">                showWarning(&quot;Invalid Year of Birth&quot;, &quot;The year of birth of your soulmate must be an integer.&quot;);</span>
<span class="fc" id="L1355">                return;</span>
<span class="fc" id="L1356">            }</span>
        }        
<span class="fc" id="L1358">        float score = -1;</span>
<span class="fc" id="L1359">        String gender = Constants.genders[gender1];</span>
<span class="fc" id="L1360">        String genderMate = Constants.genders[gender2];</span>
<span class="fc" id="L1361">        ArrayList&lt;Double&gt; linearReg = null;</span>
        try {
<span class="fc bfc" id="L1363" title="All 2 branches covered.">            if (task6RadioNKT6.isSelected()) {</span>
<span class="fc" id="L1364">                score = Activity6Query.executeNKT6(name1, gender1, year1, name2, gender2, isYounger, false);</span>
<span class="fc bfc" id="L1365" title="All 2 branches covered.">            } else if (task6RadioNorm.isSelected()) {</span>
<span class="fc" id="L1366">                score = Activity6Query.executeNKT6(name1, gender1, year1, name2, gender2, isYounger, true);</span>
            } else {
<span class="fc" id="L1368">                task6TextName1.setDisable(true);</span>
<span class="fc" id="L1369">                task6RadioMale1.setDisable(true);</span>
<span class="fc" id="L1370">                task6RadioFemale1.setDisable(true);</span>
<span class="fc" id="L1371">                task6TextYear1.setDisable(true);</span>
<span class="fc" id="L1372">                task6TextName2.setDisable(true);</span>
<span class="fc" id="L1373">                task6RadioMale2.setDisable(true);</span>
<span class="fc" id="L1374">                task6RadioFemale2.setDisable(true);</span>
<span class="fc" id="L1375">                task6RadioYounger.setDisable(true);</span>
<span class="fc" id="L1376">                task6RadioOlder.setDisable(true);</span>
<span class="fc" id="L1377">                task6RadioCustom.setDisable(true);</span>
<span class="fc" id="L1378">                task6TextYear2.setDisable(true);</span>
<span class="fc" id="L1379">                task6RadioNKT6.setDisable(true);</span>
<span class="fc" id="L1380">                task6RadioNorm.setDisable(true);</span>
<span class="fc" id="L1381">                task6RadioLinear.setDisable(true);</span>
<span class="fc" id="L1382">                task6ButtonReport.setDisable(true);</span>
<span class="fc" id="L1383">                task6ButtonCancel.setDisable(false);</span>
<span class="fc" id="L1384">                task6TextResult.setVisible(false);</span>
<span class="fc" id="L1385">                task6PieChartResult.setVisible(false);</span>
<span class="fc" id="L1386">                task6LineChartResult.setVisible(false);</span>
                
<span class="fc bfc" id="L1388" title="All 4 branches covered.">                Activity6Query.prepareLinear(name1, gender1, year1, name2, gender2, (task6RadioCustom.isSelected() ? 2 : (isYounger ? 0 : 1)), year2);</span>
                
<span class="fc" id="L1390">                task6LinTask0 = new Activity6QueryThreadTask(name1, gender1, year1, name2, gender2, year2);</span>
<span class="fc" id="L1391">                task6LinTask0.setOnFailed(wse -&gt; {</span>
<span class="fc" id="L1392">                    System.out.println(&quot;Error&quot;);</span>
<span class="fc" id="L1393">                    task6LinTask0.getException().printStackTrace();</span>
<span class="fc" id="L1394">                    showWarning(&quot;Regression Error&quot;, &quot;There are not enough data points for regression. Please use the other algorithms.&quot;);</span>
<span class="fc" id="L1395">                    resetTask6();</span>
<span class="fc" id="L1396">                });</span>
<span class="fc" id="L1397">                task6LinTask0.setOnSucceeded(wse1 -&gt; {</span>
                    //task6ProgressBar.progressProperty().unbind();
                    //task6ProgressBar.progressProperty().bind(task6LinTask2.progressProperty());
<span class="fc" id="L1400">                    tasks6Points = task6LinTask0.getValue();</span>
<span class="fc" id="L1401">                    task6LinTask1 = new LinearRegressionTask(tasks6Points.getKey());</span>
<span class="fc" id="L1402">                    task6LinTask2 = new LinearRegressionTask(tasks6Points.getValue());</span>
                    /* Checked in task 0
                    task6LinTask1.setOnFailed(wse -&gt; {
                        System.out.println(&quot;Error&quot;);
                        task6LinTask1.getException().printStackTrace();
                        showWarning(&quot;Regression Error&quot;, &quot;There are not enough data points for regression. Please use the other algorithms.&quot;);
                        resetTask6();
                    });
                    task6LinTask2.setOnFailed(wse -&gt; {
                        System.out.println(&quot;Error&quot;);
                        task6LinTask2.getException().printStackTrace();
                        showWarning(&quot;Regression Error&quot;, &quot;There are not enough data points for regression. Please use the other algorithms.&quot;);
                        resetTask6();
                    });*/
<span class="fc" id="L1416">                    task6LinTask1.setOnSucceeded(wse -&gt; {</span>
                        //super.succeeded();
                        //task6ProgressBar.progressProperty().unbind();
                        //task6ProgressBar.progressProperty().bind(task6LinTask2.progressProperty());
<span class="fc" id="L1420">                        new Thread(task6LinTask2).start();</span>
<span class="fc" id="L1421">                    });</span>
                    
<span class="fc" id="L1423">                    task6LinTask2.setOnSucceeded(wse -&gt; {</span>
                        // super.succeeded();
                        //task6ProgressBar.progressProperty().unbind();
                        //task6ProgressBar.setVisible(false);
<span class="fc" id="L1427">                        doTask6AfterThread();</span>
<span class="fc" id="L1428">                    });</span>

                    //task6ProgressBar.progressProperty().bind(task6LinTask1.progressProperty());
                    
                    //task6ProgressBar.setVisible(true);
<span class="fc" id="L1433">                    new Thread(task6LinTask1).start();</span>
<span class="fc" id="L1434">                });</span>

<span class="fc" id="L1436">                new Thread(task6LinTask0).start();</span>
<span class="fc" id="L1437">                return;</span>
            }
<span class="fc" id="L1439">        } catch(RuntimeException e) {</span>
<span class="fc" id="L1440">            System.out.println(&quot;Thread error: &quot; + e.getMessage());</span>
<span class="fc" id="L1441">            e.printStackTrace();</span>
<span class="fc bfc" id="L1442" title="All 2 branches covered.">            if(e.getMessage().equals(&quot;length1&quot;)) {</span>
<span class="fc" id="L1443">                showWarning(&quot;Invalid Name&quot;, &quot;Your name must contain only 2 to 15 characters.&quot;);</span>
<span class="fc bfc" id="L1444" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;length2&quot;)) {</span>
<span class="fc" id="L1445">                showWarning(&quot;Invalid Name&quot;, &quot;The name of your soulmate must contain only 2 to 15 characters.&quot;);</span>
<span class="fc bfc" id="L1446" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;char1&quot;)) {</span>
<span class="fc" id="L1447">                showWarning(&quot;Invalid Name&quot;, &quot;Your name must contain only letters.&quot;);</span>
<span class="fc bfc" id="L1448" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;char2&quot;)) {</span>
<span class="fc" id="L1449">                showWarning(&quot;Invalid Name&quot;, &quot;The name of your soulmate must contain only letters.&quot;);</span>
<span class="fc bfc" id="L1450" title="All 2 branches covered.">            } else if(e.getMessage().equals(&quot;year1&quot;)) {</span>
<span class="fc" id="L1451">                showWarning(&quot;Invalid Year of Birth&quot;, &quot;Your year of birth must be an integer between 1880 and 2019.&quot;);</span>
<span class="pc bpc" id="L1452" title="1 of 2 branches missed.">            } else if(e.getMessage().equals(&quot;year2&quot;)) {</span>
<span class="fc" id="L1453">                showWarning(&quot;Invalid Year of Birth&quot;, &quot;The year of birth of your soulmate must be an integer between 1880 and 2019.&quot;);</span>
<span class="nc bnc" id="L1454" title="All 4 branches missed.">            } else if(e.getMessage().equals(&quot;points&quot;) || e.getMessage().equals(&quot;linear&quot;)) {</span>
<span class="nc" id="L1455">                showWarning(&quot;Regression Error&quot;, &quot;There are not enough data points for regression. Please use the other algorithms.&quot;);</span>
            }
<span class="fc" id="L1457">            resetTask6();</span>
<span class="fc" id="L1458">            return;</span>
<span class="fc" id="L1459">        }</span>
<span class="fc" id="L1460">        DecimalFormat df = new DecimalFormat(&quot;0&quot;);</span>
<span class="fc" id="L1461">        df.setMaximumFractionDigits(340);        </span>
<span class="fc" id="L1462">        task6TextResult.setText(&quot;Your score of compatibility is &quot; + df.format(AnalyzeNames.round(score * 100, 5)) + &quot;%&quot;);</span>
<span class="fc" id="L1463">        task6TextResult.setVisible(true);</span>

<span class="pc bpc" id="L1465" title="1 of 4 branches missed.">        if (task6RadioNorm.isSelected() || task6RadioLinear.isSelected()) {</span>
<span class="fc" id="L1466">            task6PieChartResult.getData().clear();</span>
<span class="fc" id="L1467">            task6PieChartResult.setVisible(true);</span>

<span class="fc" id="L1469">            PieChart.Data sliceScore = new PieChart.Data(&quot;Score&quot;, score);</span>
<span class="fc" id="L1470">            PieChart.Data sliceSpace = new PieChart.Data(&quot;Space&quot;  , 1 - score);</span>

<span class="fc" id="L1472">            task6PieChartResult.getData().add(sliceScore);</span>
<span class="fc" id="L1473">            task6PieChartResult.getData().add(sliceSpace);</span>
<span class="fc" id="L1474">            task6PieChartResult.setScaleShape(true);</span>

<span class="fc" id="L1476">            sliceSpace.getNode().setStyle(&quot;-fx-pie-color: #1d1d1d;&quot;);</span>
<span class="fc" id="L1477">        } else {</span>
<span class="fc" id="L1478">            task6PieChartResult.setVisible(false);</span>
        }
<span class="fc" id="L1480">        task6LineChartResult.setVisible(false);</span>
<span class="fc" id="L1481">    }</span>

    /**
     * 
     */
    @FXML
    void resetTask6() {
<span class="fc" id="L1488">    	task6TextName1.setDisable(false);</span>
<span class="fc" id="L1489">        task6RadioMale1.setDisable(false);</span>
<span class="fc" id="L1490">        task6RadioFemale1.setDisable(false);</span>
<span class="fc" id="L1491">        task6TextYear1.setDisable(false);</span>
<span class="fc" id="L1492">        task6TextName2.setDisable(false);</span>
<span class="fc" id="L1493">        task6RadioMale2.setDisable(false);</span>
<span class="fc" id="L1494">        task6RadioFemale2.setDisable(false);</span>
<span class="fc" id="L1495">        task6RadioYounger.setDisable(false);</span>
<span class="fc" id="L1496">        task6RadioOlder.setDisable(false);</span>
<span class="fc" id="L1497">        task6RadioCustom.setDisable(false);</span>
<span class="fc" id="L1498">        task6TextYear2.setDisable(false);</span>
<span class="fc" id="L1499">        task6RadioNKT6.setDisable(false);</span>
<span class="fc" id="L1500">        task6RadioNorm.setDisable(false);</span>
<span class="fc" id="L1501">        task6RadioLinear.setDisable(false);</span>
<span class="fc" id="L1502">        task6ButtonReport.setDisable(false);</span>
<span class="fc" id="L1503">        task6ButtonCancel.setDisable(true);</span>
<span class="fc" id="L1504">        task6ProgressBar.setVisible(false);</span>
<span class="fc" id="L1505">        task6TextResult.setVisible(false);</span>
<span class="fc" id="L1506">        task6PieChartResult.setVisible(false);</span>
<span class="fc" id="L1507">        task6LineChartResult.setVisible(false);</span>
<span class="fc" id="L1508">    }</span>

    /**
     * 
     */
    @FXML
    void doTask6AfterThread() {
<span class="fc" id="L1515">        resetTask6();        </span>

        String name1, name2;
        int gender1, gender2;
        int year1, year2;
<span class="fc" id="L1520">        boolean isYounger = true;</span>
<span class="fc" id="L1521">        name1 = task6TextName1.getText();</span>
<span class="fc" id="L1522">        name2 = task6TextName2.getText();</span>
<span class="fc bfc" id="L1523" title="All 2 branches covered.">        if (task6RadioMale1.isSelected()) {</span>
<span class="fc" id="L1524">            gender1 = 0;</span>
        } else {
<span class="fc" id="L1526">            gender1 = 1;</span>
        }
<span class="fc" id="L1528">        year1 = Integer.parseInt(task6TextYear1.getText());</span>
<span class="fc bfc" id="L1529" title="All 2 branches covered.">        if (task6RadioMale2.isSelected()) {</span>
<span class="fc" id="L1530">            gender2 = 0;</span>
        } else {
<span class="fc" id="L1532">            gender2 = 1;</span>
        }
<span class="fc bfc" id="L1534" title="All 2 branches covered.">        if (task6RadioYounger.isSelected()) {</span>
<span class="fc" id="L1535">            isYounger = true;</span>
<span class="fc" id="L1536">            year2 = year1 + 1;</span>
<span class="fc bfc" id="L1537" title="All 2 branches covered.">        } else if (task6RadioOlder.isSelected()) {</span>
<span class="fc" id="L1538">            isYounger = false;</span>
<span class="fc" id="L1539">            year2 = year1 - 1;</span>
        } else {
<span class="fc" id="L1541">            year2 = Integer.parseInt(task6TextYear2.getText());</span>
        }        
        float score;
<span class="fc" id="L1544">        String gender = Constants.genders[gender1];</span>
<span class="fc" id="L1545">        String genderMate = Constants.genders[gender2];</span>
<span class="fc" id="L1546">        ArrayList&lt;Double&gt; linearReg = null;</span>
<span class="fc" id="L1547">        Pair&lt;Double, ArrayList&lt;Double&gt;&gt; ret = Activity6Query.executeLinear(task6LinTask1.getValue(), task6LinTask2.getValue(), year1, year2);</span>
<span class="fc" id="L1548">        score = (float)ret.getKey().doubleValue();</span>
<span class="fc" id="L1549">        linearReg = ret.getValue();</span>

<span class="fc" id="L1551">        DecimalFormat df = new DecimalFormat(&quot;0&quot;);</span>
<span class="fc" id="L1552">        df.setMaximumFractionDigits(340);        </span>
<span class="fc" id="L1553">        task6TextResult.setText(&quot;Your score of compatibility is &quot; + df.format(AnalyzeNames.round(score * 100, 5)) + &quot;%&quot;);</span>
<span class="fc" id="L1554">        task6TextResult.setVisible(true);</span>

<span class="fc" id="L1556">        task6PieChartResult.getData().clear();</span>
<span class="fc" id="L1557">        task6PieChartResult.setVisible(true);</span>

<span class="fc" id="L1559">        PieChart.Data sliceScore = new PieChart.Data(&quot;Score&quot;, score);</span>
<span class="fc" id="L1560">        PieChart.Data sliceSpace = new PieChart.Data(&quot;Space&quot;  , 1 - score);</span>

<span class="fc" id="L1562">        task6PieChartResult.getData().add(sliceScore);</span>
<span class="fc" id="L1563">        task6PieChartResult.getData().add(sliceSpace);</span>

<span class="fc" id="L1565">        sliceSpace.getNode().setStyle(&quot;-fx-pie-color: #1d1d1d;&quot;);</span>
    
<span class="fc" id="L1567">        task6LineChartResult.setVisible(true);</span>
<span class="fc" id="L1568">        task6LineChartResult.getData().clear();</span>
<span class="fc" id="L1569">        XYChart.Series&lt;Integer, Number&gt; series1 = new XYChart.Series&lt;&gt;();</span>
<span class="fc" id="L1570">        XYChart.Series&lt;Integer, Number&gt; series2 = new XYChart.Series&lt;&gt;();</span>
<span class="fc" id="L1571">        XYChart.Series&lt;Integer, Number&gt; series3 = new XYChart.Series&lt;&gt;();</span>
<span class="fc" id="L1572">        XYChart.Series&lt;Integer, Number&gt; series4 = new XYChart.Series&lt;&gt;();</span>
<span class="fc" id="L1573">        series1.setName(name1);</span>
<span class="fc" id="L1574">        series2.setName(name2);</span>
<span class="fc" id="L1575">        series3.setName(name1 + &quot; Regression&quot;);</span>
<span class="fc" id="L1576">        series4.setName(name2 + &quot; Regression&quot;);</span>

<span class="fc" id="L1578">        RankRecord record = null;</span>
<span class="fc" id="L1579">        RankRecord recordMate = null;</span>
<span class="fc" id="L1580">        int startYear = Math.max(year1, year2);</span>
<span class="fc bfc" id="L1581" title="All 2 branches covered.">        for(int year = startYear; year &lt;= 2019; ++year) {</span>
<span class="fc" id="L1582">            record = AnalyzeNames.getRankRecord(year, name1, gender);</span>
<span class="fc" id="L1583">            recordMate = AnalyzeNames.getRankRecord(year, name2, genderMate);</span>
<span class="fc bfc" id="L1584" title="All 2 branches covered.">            if (record.isValid()) {</span>
<span class="fc" id="L1585">                series1.getData().add(new XYChart.Data&lt;Integer, Number&gt;(year, record.getRank()));</span>
            }
<span class="fc bfc" id="L1587" title="All 2 branches covered.">            if (recordMate.isValid()) {</span>
<span class="fc" id="L1588">                series2.getData().add(new XYChart.Data&lt;Integer, Number&gt;(year, recordMate.getRank()));</span>
            }
        }
<span class="fc" id="L1591">        series3.getData().add(new XYChart.Data&lt;Integer, Number&gt;(startYear, linearReg.get(1).doubleValue()));</span>
<span class="fc" id="L1592">        series3.getData().add(new XYChart.Data&lt;Integer, Number&gt;(2019, linearReg.get(0).doubleValue() * (2019 - startYear) + linearReg.get(1).doubleValue()));</span>
<span class="fc" id="L1593">        series4.getData().add(new XYChart.Data&lt;Integer, Number&gt;(Math.max(year1, year2), linearReg.get(3).doubleValue()));</span>
<span class="fc" id="L1594">        series4.getData().add(new XYChart.Data&lt;Integer, Number&gt;(2019, linearReg.get(2).doubleValue() * (2019 - startYear) + linearReg.get(3).doubleValue()));</span>
        
<span class="fc" id="L1596">        task6LineChartResult.getData().add(series1);</span>
<span class="fc" id="L1597">        task6LineChartResult.getData().add(series2);</span>
<span class="fc" id="L1598">        task6LineChartResult.getData().add(series3);</span>
<span class="fc" id="L1599">        task6LineChartResult.getData().add(series4);        </span>
<span class="fc" id="L1600">    }</span>

    /**
     * @param header
     * @param message
     */
    private static void showWarning(String header, String message) {
<span class="fc" id="L1607">        Alert alert = new Alert(AlertType.WARNING);</span>
<span class="fc" id="L1608">        alert.setTitle(&quot;Warning&quot;);</span>
<span class="fc" id="L1609">        alert.setHeaderText(header);</span>
<span class="fc" id="L1610">        alert.setContentText(message);</span>
<span class="fc" id="L1611">        alert.getDialogPane().setMinHeight(Region.USE_PREF_SIZE);</span>
<span class="fc" id="L1612">        alert.showAndWait();</span>
<span class="fc" id="L1613">    }</span>
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>